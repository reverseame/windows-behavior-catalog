# Windows Behavior Catalog (WBC)
In this repository you will find a corpus of common Windows behaviors and their corresponding implementation. The source code is written in C++ and has been tested with `cl` (`Microsoft (R) C/C++ Optimizing Compiler Version 19.34.31935 for x86`). **The files have been compiled and tested under Windows 10 Pro Version 10.0.19044 Build 19044**.

The vast majority of the behaviors here defined are based on the [Malware Behavior Catalog (MBC)](https://github.com/MBCProject/mbc-markdown)'s micro-behaviors.

# Contents

## Naming
In order to understand what a micro-objective, micro-behavior, or method is, please refer to the [MBC](https://github.com/MBCProject/mbc-markdown). The contents of this catalog uses the following naming convention:
 
- **OC####**: Micro-Objective 
- **C####**: Micro-Behavior
- **C####.###**: Method
- **X** at the end: eXpanded by us (with respect to the MBC)
	- Behaviors we consider relevant but are not included in the MBC as of the moment of this writing. We will eventually pull request the MBC to include them, if they deem it. 
- **P####**: Individual behavioral pattern
- **H** at the end: Manually added pattern
	- Behavioral patterns both single or multiple nodes long we manually added to a specific method. This situation occurs when there is a behavior unequivocally identified by any pattern that does not arise as a result of our behavioral pattern generation algorithm (from the Category Graphs).

## Categories
The code is divided into several categories:

- TODO

Within each category you will find the all the associated behaviors and their corresponding source code files as well as the executables and the reports generated from CAPEv2. For each behavior, the source code file has (or pretends to) a self-explanatory name. Within each category folder you will find the following structure: 

- **src**: Folder containing the source code files.
- ~~**exe**: Folder containing the executable files.~~
- **reports**: Folder containing the report files, as generated by CAPEv2 (JSON formatted).
- **gv**: Folder containing the _graphviz_ files, used to perform pattern matching and other analysis techniques.

## Source Code
The contents present in this repository have been developed in part by the authors of the repo and other have been copied or adapted from other sources. Whenever the latter, the corresponding authors are credited.

Each behavior's implementations pretends to be the simplest working example of such behavior. Keep things simple and straight to the point!

## Compilation

Files have been compiled with `cl`. The same compiler Visual Studio uses, bur from the command line: [Use the Microsoft C++ toolset from the command line](https://learn.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-170). You can find more information and instructions here: [Walkthrough: Compiling a Native C++ Program on the Command Line](https://learn.microsoft.com/en-us/cpp/build/walkthrough-compiling-a-native-cpp-program-on-the-command-line?view=msvc-170).

The specific command used to compile each `.cpp` file is specified within the header of the file itself.

## TODO
- Review Crypto micro objective and behaviors.
- Code for:
	- NtDeleteFile
	- NtOpenFile

# Authors
This repository was created and (sometimes) maintained by:

[Razvan Raducu](https://razvioverflow.github.io/)